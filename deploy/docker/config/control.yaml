# Control Plane Configuration
# Manages distributed DNS workers

mode: control

# Control plane doesn't serve DNS, so server config is minimal
server:
  listen_address: ""  # No DNS listener
  num_workers: 1
  enable_tcp: false
  pprof_address: ":6060"
  graceful_shutdown_timeout: 30s
  stats_report_interval: 10s

control_plane:
  grpc_address: ":9090"
  heartbeat_timeout: 30s

# API for management GUI
api:
  enabled: true
  listen_address: ":8080"
  cors_origins:
    - "*"
  auth:
    username: admin
    password_hash: ""
    jwt_secret: ""
    token_expiry: 24h

logging:
  level: info
  format: json
  enable_query_log: false

# Default resolver config to push to workers
resolver:
  mode: parallel
  upstreams:
    - "8.8.8.8:53"
    - "8.8.4.4:53"
    - "1.1.1.1:53"
    - "1.0.0.1:53"
  max_recursion_depth: 30
  query_timeout: 5s
  enable_coalescing: true
  parallel:
    num_parallel: 3
    fallback_to_recursive: true
    success_rcodes: [0, 3]

# Default cache config to push to workers
cache:
  message_cache:
    max_size_mb: 128
    num_shards: 64
  rrset_cache:
    max_size_mb: 256
    num_shards: 128
  prefetch:
    enabled: true
    threshold_hits: 100
    threshold_ttl_percent: 0.1
  min_ttl: 60s
  max_ttl: 24h
  negative_ttl: 1h
